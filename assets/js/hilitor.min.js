function Hilitor(d,m){var h=document.getElementById(d)||document.body;var g=m||"EM";var c=new RegExp("^(?:"+g+"|SCRIPT|FORM|SPAN)$");var b=["#ff6","#a0ffff","#9f9","#f99","#f6f"];var f=[];var l=0;var k="";var j=false;var a=false;var e=new RegExp("^[^\\w]+|[^\\w]+$","g");var i=new RegExp("[^\\w'-]+","g");this.setMatchType=function(n){switch(n){case"left":this.openLeft=false;this.openRight=true;break;case"right":this.openLeft=true;this.openRight=false;break;case"open":this.openLeft=this.openRight=true;break;default:this.openLeft=this.openRight=false}};this.setRegex=function(n){n=n.replace(e,"");n=n.replace(i,"|");n=n.replace(/^\||\|$/g,"");if(n){var o="("+n+")";if(!this.openLeft){o="\\b"+o}if(!this.openRight){o=o+"\\b"}k=new RegExp(o,"i");return true}return false};this.getRegex=function(){var n=k.toString();n=n.replace(/(^\/(\\b)?|\(|\)|(\\b)?\/i$)/g,"");n=n.replace(/\|/g," ");return n};this.hiliteWords=function(p){if(p===undefined||!p){return}if(!k){return}if(c.test(p.nodeName)){return}if(p.hasChildNodes()){for(var o=0;o<p.childNodes.length;o++){this.hiliteWords(p.childNodes[o])}}if(p.nodeType==3){if((nv=p.nodeValue)&&(regs=k.exec(nv))){if(!f[regs[0].toLowerCase()]){f[regs[0].toLowerCase()]=b[l++%b.length]}var n=document.createElement(g);n.appendChild(document.createTextNode(regs[0]));n.style.backgroundColor=f[regs[0].toLowerCase()];n.style.fontStyle="inherit";n.style.color="#000";var q=p.splitText(regs.index);q.nodeValue=q.nodeValue.substring(regs[0].length);p.parentNode.insertBefore(n,q)}}};this.remove=function(){var n=document.getElementsByTagName(g);while(n.length&&(el=n[0])){var o=el.parentNode;o.replaceChild(el.firstChild,el);o.normalize()}};this.apply=function(n){this.remove();if(n===undefined||!n){return}if(this.setRegex(n)){this.hiliteWords(h)}}};